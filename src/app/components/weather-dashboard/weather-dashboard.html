<div class="dashboard-container">
    <div class="search-section">
        <h1>Weather Forecast</h1>
        <div class="search-container hierarchical-search">
            <!-- Country Selection -->
            <div class="input-group">
                <select [(ngModel)]="selectedCountry">
                    <option *ngFor="let country of countries" [value]="country">{{ country }}</option>
                </select>
            </div>

            <!-- State/Region Input -->
            <div class="input-group">
                <input type="text" [ngModel]="stateName" (input)="onStateInput($event)"
                    placeholder="State (e.g. Karnataka)" autocomplete="off">

                <div class="dropdown-menu" *ngIf="showStateDropdown && stateSearchResults.length > 0">
                    <div class="dropdown-item" *ngFor="let result of stateSearchResults" (click)="selectState(result)">
                        <div class="location-name">{{ result.name }}</div>
                        <div class="location-details">
                            <span *ngIf="result.country">{{ result.country }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Village/City Input -->
            <div class="search-box input-group">
                <input type="text" [ngModel]="villageName" (input)="onSearchInput($event)"
                    (keyup.enter)="searchWeather()" placeholder="Village / City..." [class.error]="error"
                    autocomplete="off">
                <button (click)="searchWeather()" [disabled]="loading">
                    <span *ngIf="!loading">Search</span>
                    <span *ngIf="loading">Loading...</span>
                </button>
            </div>

            <div class="dropdown-menu" *ngIf="showDropdown && searchResults.length > 0">
                <div class="dropdown-item" *ngFor="let result of searchResults" (click)="selectCity(result)">
                    <div class="location-name">{{ result.name }}</div>
                    <div class="location-details">
                        <span *ngIf="result.admin1">{{ result.admin1 }}, </span>
                        <span *ngIf="result.country">{{ result.country }}</span>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="error" class="error-message">
            {{ error }}
        </div>
    </div>

    <div class="content-section">
        <div class="results-container">
            <app-weather-card *ngIf="weatherData" [weather]="weatherData"></app-weather-card>

            <div class="map-container" *ngIf="mapUrl">
                <h2>Location Map</h2>
                <div class="map-frame">
                    <iframe [src]="mapUrl" width="100%" height="300" frameborder="0" style="border:0" allowfullscreen>
                    </iframe>
                </div>
            </div>
        </div>
    </div>
</div>